# 疑难杂症

下面记录了一些搓系统过程中碰到的疑难杂症：

## 没有输出，好似卡死了

一般有两种可能：不支持输出，或是反复产生异常。具体来说有可能是

1. 没成功进入内核控制流，碰到了异常指令；可能是 elf 没有作为内核加载，或 SBI 不支持加载 elf
2. sbi 不支持输出
3. 进入控制流后碰到异常指令，trap handler 没有处理直接返回，导致反复异常
4. 用户态使用了内核态的系统调用，或是内核态使用了用户态的系统调用
5. 栈被破坏了，导致非法寻址

## 反复输出一行，没有写死循环的情况下死循环了

一般是反复产生异常，可能是

1. 控制流产生了异常但是上级 trap handler 只是输出，没有处理直接返回，导致反复异常
2. 控制流调用了 console ecall 但是 trap handler 没有修改 sepc/mepc 跳转到下一条指令，导致 ecall 被反复调用

